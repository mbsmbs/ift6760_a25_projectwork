device: cpu
float_precision: 32
n_samples: 10000
seed: 0
env:
  _target_: gflownet.envs.conformers.conformer.Conformer
  reward_func: boltzmann
  reward_min: 1.0e-08
  reward_beta: 10
  reward_norm: 1.0
  reward_norm_std_mult: 0.0
  proxy_state_format: oracle
  skip_mask_check: false
  conditional: false
  continuous: false
  buffer:
    replay_capacity: 1000
    train: null
    test:
      path: null
      type: random
      seed: 0
      'n': 4096
      output_csv: conformer_test.csv
      output_pkl: conformer_test.pkl
    data_path: null
  smiles: CC(C)Cc1ccc(cc1)[C@@H](C)C(=O)O
  n_torsion_angles: -1
  reward_sampling_method: nested
  id: conformer
  policy_encoding_dim_per_angle: 10
  length_traj: 5
  vonmises_min_concentration: 4
  n_comp: 5
  fixed_distribution:
    vonmises_mean: 0.0
    vonmises_concentration: 0.5
  random_distribution:
    vonmises_mean: 0.0
    vonmises_concentration: 0.001
  policy_type: mlp
gflownet:
  _target_: gflownet.gflownet.GFlowNetAgent
  seed: 0
  optimizer:
    loss: trajectorybalance
    lr: 0.0001
    lr_decay_period: 1000000
    lr_decay_gamma: 0.5
    method: adam
    early_stopping: 0.0
    ema_alpha: 0.5
    adam_beta1: 0.9
    adam_beta2: 0.999
    sgd_momentum: 0.9
    batch_size:
      forward: 80
      backward_dataset: 0
      backward_replay: 20
    train_to_sample_ratio: 1
    n_train_steps: 5000
    bootstrap_tau: 0.0
    clip_grad_norm: 0.0
    lr_z_mult: 100
    z_dim: 16
  batch_reward: true
  mask_invalid_actions: true
  temperature_logits: 1.0
  random_action_prob: 0.1
  pct_offline: 0.0
  replay_capacity: 0
  replay_sampling: weighted
  num_empirical_loss: 200000
  oracle:
    'n': 500
  sample_only: false
  active_learning: false
policy:
  _target_: gflownet.policy.base.Policy
  shared:
    type: mlp
    n_hid: 512
    n_layers: 5
  forward:
    checkpoint: forward.ckpt
  backward:
    shared_weights: false
    checkpoint: backward.ckpt
proxy:
  _target_: gflownet.proxy.conformers.torchani.TorchANIMoleculeEnergy
  model: ANI2x
  use_ensemble: true
logger:
  _target_: gflownet.utils.logger.Logger
  do:
    online: false
    times: false
  project_name: gflownet
  train:
    period: 1
  test:
    first_it: true
    period: 10000
    'n': 10000
    kde:
      bandwidth: 0.1
      kernel: gaussian
    n_top_k: 5000
    top_k: 100
    top_k_period: -1
    n_trajs_logprobs: 10
    logprobs_batch_size: 100
    max_data_logprobs: 100000.0
  oracle:
    period: 100000
    k:
    - 1
    - 10
    - 100
  checkpoints:
    period: 10000
  logdir:
    root: ./logs
    ckpts: ckpts
    overwrite: true
  debug: false
  lightweight: true
  progress: true
  context: '0'
  tags:
  - gflownet
  - continuous
  - molecule
user:
  logdir:
    root: /network/scratch/h/hernanga/logs/gflownet
  data:
    root: /home/mila/h/hernanga/gflownet/data
    alanine_dipeptide: /home/mila/h/hernanga/gflownet/data/alanine_dipeptide_conformers_1.npy
